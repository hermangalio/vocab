{% extends "base.html" %}
{% block title %}Vocab App — Dashboard{% endblock %}

{% block content %}
<h1>Your Word Lists</h1>

<p>Upload a chapter or passage you're about to read and we'll extract the difficult vocabulary from it. Master the hard words first, so when you read the actual text, nothing slows you down. No multiple choice — you define each word from scratch, then get graded by AI using criteria from the <a href="https://en.wikipedia.org/wiki/Wechsler_Adult_Intelligence_Scale" target="_blank">WAIS</a>, the gold-standard IQ test. The app calibrates to your level for each document, zeroing in on words you don't yet know. Even if you have no idea, guess anyway — the attempt primes your memory and makes the correct definition stick better when you see it (a concept known as <a href="https://lse.ethz.ch/research/productive-failure.html" target="_blank">productive failure</a>, pioneered by ETH Zurich professor Manu Kapur).</p>

<a href="{{ url_for('upload') }}" role="button">Upload a PDF</a>

{% if stats %}
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>In Range</th>
            <th>Mastered</th>
            <th>Progress</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for s in stats %}
        <tr>
            <td>
                <a href="{{ url_for('word_list', list_id=s.list.id) }}">{{ s.list.name }}</a>
                {% if s.list.status == 'processing' %}
                <small>(processing...)</small>
                {% elif s.list.status == 'error' %}
                <small>(error)</small>
                {% endif %}
            </td>
            <td>{{ s.in_range }} <small>/ {{ s.total }}</small></td>
            <td>{{ s.mastered }}</td>
            <td>
                <progress value="{{ s.mastered }}" max="{{ s.in_range }}"></progress>
                {{ s.pct }}%
            </td>
            <td>
                {% if s.list.status == 'done' and s.list.zipf_threshold is none %}
                <a href="{{ url_for('calibrate', list_id=s.list.id) }}" role="button" class="outline">Calibrate</a>
                {% elif s.list.status == 'done' and s.in_range > 0 %}
                <a href="{{ url_for('quiz', list_id=s.list.id) }}" role="button" class="outline">Quiz</a>
                {% endif %}
                <form method="post" action="{{ url_for('delete_word_list', list_id=s.list.id) }}" style="display:inline">
                    <button type="submit" class="outline secondary" onclick="return confirm('Delete this word list?')">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No word lists yet. Upload a PDF to get started!</p>
{% endif %}
{% endblock %}
