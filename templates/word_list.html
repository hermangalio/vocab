{% extends "base.html" %}
{% block title %}{{ word_list.name }}{% endblock %}

{% block content %}
<hgroup>
    <h1>{{ word_list.name }}</h1>
    <p>{{ words | length }} words, sorted by rarity (rarest first)</p>
</hgroup>

<div class="stats-grid">
    <div class="stat-card">
        <span class="number">{{ words | length }}</span>
        <span class="label">Total Words</span>
    </div>
    <div class="stat-card">
        <span class="number">{{ words | selectattr('mastered') | list | length }}</span>
        <span class="label">Mastered</span>
    </div>
    <div class="stat-card">
        <span class="number">{{ words | rejectattr('mastered') | list | length }}</span>
        <span class="label">Remaining</span>
    </div>
</div>

<a href="{{ url_for('quiz', list_id=word_list.id) }}" role="button">Start Quiz</a>
<a href="{{ url_for('calibrate', list_id=word_list.id) }}" role="button" class="outline">Re-calibrate</a>
<a href="{{ url_for('index') }}" role="button" class="outline">Back to Dashboard</a>

{% if threshold is not none %}
<details style="margin-top: 0.5rem;">
    <summary><small>Threshold: {{ "%.2f" | format(threshold) }} â€” adjust</small></summary>
    <form method="post" action="{{ url_for('set_threshold', list_id=word_list.id) }}" role="group" style="margin-top: 0.5rem; max-width: 200px;">
        <input type="number" name="threshold" step="0.1" min="0.5" max="7.0" value="{{ '%.1f' | format(threshold) }}" required>
        <button type="submit" class="outline">Set</button>
    </form>
</details>
{% endif %}

<table>
    <thead>
        <tr>
            <th>#</th>
            <th>Word</th>
            <th>Zipf Score</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for word in words %}
        <tr class="{{ 'mastered' if word.mastered }}">
            <td>{{ loop.index }}</td>
            <td>{{ word.word }}</td>
            <td>{{ "%.2f" | format(word.zipf_score) }}</td>
            <td>{{ "Mastered" if word.mastered else "" }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
